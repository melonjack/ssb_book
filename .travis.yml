# Ubuntu (xenial) as operating system
dist: xenial

# Setup rust environment with stable language branch only
language: rust
rust: stable

# Cache build dependencies
cache: cargo

# Execute build
script: cargo build --verbose

# Post processing
addons:
  apt:
    packages:
      - inkscape
after_success: inkscape --without-gui --export-text-to-path --export-pdf=target/book/ssb_reference_card.pdf target/book/ssb_reference_card.svg

# Deploy build to release platform
deploy:
  provider: pages # Github Pages
  github-token: $GITHUB_TOKEN # Access token for deploy target
  skip-cleanup: true  # Don't clean away output for deploy
  local-dir: "target/book" # Directory to push to Github repository
  repo: "substation-beta/substation-beta.github.io"  # Target repository
  target-branch: "master" # Branch of target repository